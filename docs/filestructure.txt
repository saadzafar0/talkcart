================================================
TALKCHART - AI PERSONAL SHOPPER
Modular File Structure Documentation
================================================

ðŸŽ¯ ARCHITECTURE PHILOSOPHY
- Feature-based modular structure
- Each feature is self-contained and can be enabled/disabled
- LangChain integration for AI tools and chains
- Clear separation: UI â†” Business Logic â†” Data Layer
- Plugin-like architecture for extensibility

================================================
ðŸ“ PROJECT ROOT
================================================

talkchart/
â”œâ”€â”€ ðŸ“„ prd.txt                      # Product requirements & hackathon challenge
â”œâ”€â”€ ðŸ“„ techdoc.txt                  # Technical stack & color scheme
â”œâ”€â”€ ðŸ“„ schema.txt                   # Database schema & SQL
â”œâ”€â”€ ðŸ“„ filestructure.txt            # This file
â”œâ”€â”€ ðŸ“„ package.json                 # Dependencies & scripts
â”œâ”€â”€ ðŸ“„ tsconfig.json                # TypeScript configuration
â”œâ”€â”€ ðŸ“„ next.config.ts               # Next.js configuration
â”œâ”€â”€ ðŸ“„ postcss.config.mjs           # PostCSS & Tailwind setup
â”œâ”€â”€ ðŸ“„ tailwind.config.ts           # Tailwind customization (colors)
â”œâ”€â”€ ðŸ“„ .env.local                   # Environment variables (API keys)
â”œâ”€â”€ ðŸ“„ .env.example                 # Example env file
â”œâ”€â”€ ðŸ“„ .gitignore                   # Git ignore rules
â””â”€â”€ ðŸ“„ README.md                    # Setup & deployment docs

================================================
ðŸ“ SRC/ - MODULAR SOURCE CODE
================================================

src/
â”œâ”€â”€ ðŸ“ app/                         # Next.js App Router (Presentation Layer)
â”œâ”€â”€ ðŸ“ features/                    # Feature Modules (Business Logic)
â”œâ”€â”€ ðŸ“ core/                        # Core/Shared Modules
â”œâ”€â”€ ðŸ“ langchain/                   # LangChain AI Integration
â””â”€â”€ ðŸ“ infrastructure/              # Infrastructure Layer (DB, APIs, etc.)

================================================
ðŸ“ APP/ - NEXT.JS APP ROUTER (PRESENTATION)
================================================

src/app/
â”œâ”€â”€ ðŸ“„ layout.tsx                   # Root layout with providers
â”œâ”€â”€ ðŸ“„ globals.css                  # Global styles + CSS variables
â”œâ”€â”€ ðŸ“„ page.tsx                     # Landing/Home page
â”‚
â”œâ”€â”€ ðŸ“ (store)/                     # Route group: Main store
â”‚   â”œâ”€â”€ ðŸ“ products/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ page.tsx             # Product listing page
â”‚   â”‚   â””â”€â”€ ðŸ“ [slug]/
â”‚   â”‚       â””â”€â”€ ðŸ“„ page.tsx         # Product detail page
â”‚   â”‚       â””â”€â”€ ðŸ“„ loading.tsx      # Loading UI
â”‚   â”‚       â””â”€â”€ ðŸ“„ error.tsx        # Error boundary
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ cart/
â”‚   â”‚   â””â”€â”€ ðŸ“„ page.tsx             # Cart page
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ checkout/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ page.tsx             # Checkout form
â”‚   â”‚   â””â”€â”€ ðŸ“ success/
â”‚   â”‚       â””â”€â”€ ðŸ“„ page.tsx         # Order confirmation
â”‚   â”‚
â”‚   â””â”€â”€ ðŸ“ orders/
â”‚       â”œâ”€â”€ ðŸ“„ page.tsx             # Order history
â”‚       â””â”€â”€ ðŸ“ [id]/
â”‚           â””â”€â”€ ðŸ“„ page.tsx         # Order details
â”‚
â”œâ”€â”€ ðŸ“ (auth)/                      # Route group: Authentication
â”‚   â”œâ”€â”€ ðŸ“„ layout.tsx               # Auth layout (centered form)
â”‚   â”œâ”€â”€ ðŸ“ login/
â”‚   â”‚   â””â”€â”€ ðŸ“„ page.tsx
â”‚   â””â”€â”€ ðŸ“ register/
â”‚       â””â”€â”€ ðŸ“„ page.tsx
â”‚
â””â”€â”€ ðŸ“ api/                         # API Routes (thin controllers)
    â”œâ”€â”€ ðŸ“ auth/
    â”‚   â”œâ”€â”€ ðŸ“„ register/route.ts    # Delegates to features/auth
    â”‚   â”œâ”€â”€ ðŸ“„ login/route.ts
    â”‚   â””â”€â”€ ðŸ“„ logout/route.ts
    â”‚
    â”œâ”€â”€ ðŸ“ products/
    â”‚   â”œâ”€â”€ ðŸ“„ route.ts             # GET /api/products
    â”‚   â”œâ”€â”€ ðŸ“ [slug]/
    â”‚   â”‚   â””â”€â”€ ðŸ“„ route.ts         # GET /api/products/:slug
    â”‚   â””â”€â”€ ðŸ“ search/
    â”‚       â””â”€â”€ ðŸ“„ route.ts         # POST /api/products/search (RAG)
    â”‚
    â”œâ”€â”€ ðŸ“ cart/
    â”‚   â”œâ”€â”€ ðŸ“„ route.ts             # GET /api/cart
    â”‚   â”œâ”€â”€ ðŸ“ add/route.ts         # POST /api/cart/add
    â”‚   â””â”€â”€ ðŸ“ remove/[itemId]/route.ts
    â”‚
    â”œâ”€â”€ ðŸ“ chat/
    â”‚   â”œâ”€â”€ ðŸ“„ route.ts             # POST /api/chat (LangChain agent)
    â”‚   â””â”€â”€ ðŸ“ history/route.ts
    â”‚
    â”œâ”€â”€ ðŸ“ haggle/
    â”‚   â”œâ”€â”€ ðŸ“„ route.ts             # POST /api/haggle
    â”‚   â””â”€â”€ ðŸ“ accept/route.ts
    â”‚
    â””â”€â”€ ðŸ“ orders/
        â”œâ”€â”€ ðŸ“„ route.ts
        â””â”€â”€ ðŸ“ [id]/route.ts

================================================
ðŸ“ FEATURES/ - FEATURE MODULES (BUSINESS LOGIC)
================================================

Each feature is self-contained with:
- UI components
- Business logic
- Types
- Hooks
- API services
- State management

src/features/
â”‚
â”œâ”€â”€ ðŸ“ auth/                        # Authentication Feature
â”‚   â”œâ”€â”€ ðŸ“„ index.ts                 # Public API exports
â”‚   â”œâ”€â”€ ðŸ“ components/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ LoginForm.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ RegisterForm.tsx
â”‚   â”‚   â””â”€â”€ ðŸ“„ AuthGuard.tsx
â”‚   â”œâ”€â”€ ðŸ“ hooks/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ useAuth.ts
â”‚   â”‚   â””â”€â”€ ðŸ“„ useSession.ts
â”‚   â”œâ”€â”€ ðŸ“ services/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ authService.ts       # Login, register, logout logic
â”‚   â”‚   â””â”€â”€ ðŸ“„ tokenService.ts      # JWT handling
â”‚   â”œâ”€â”€ ðŸ“ store/
â”‚   â”‚   â””â”€â”€ ðŸ“„ authSlice.ts         # Redux state
â”‚   â”œâ”€â”€ ðŸ“ types/
â”‚   â”‚   â””â”€â”€ ðŸ“„ index.ts             # User, Session, LoginRequest, etc.
â”‚   â””â”€â”€ ðŸ“ utils/
â”‚       â””â”€â”€ ðŸ“„ validators.ts        # Email, password validation
â”‚
â”œâ”€â”€ ðŸ“ products/                    # Product Catalog Feature
â”‚   â”œâ”€â”€ ðŸ“„ index.ts
â”‚   â”œâ”€â”€ ðŸ“ components/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ProductCard.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ProductGrid.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ProductDetail.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ProductFilters.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ProductSort.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ProductReviews.tsx
â”‚   â”‚   â””â”€â”€ ðŸ“„ ProductImage.tsx
â”‚   â”œâ”€â”€ ðŸ“ hooks/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ useProducts.ts       # Fetch & filter products
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ useProductDetail.ts
â”‚   â”‚   â””â”€â”€ ðŸ“„ useProductFilters.ts
â”‚   â”œâ”€â”€ ðŸ“ services/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ productService.ts    # CRUD operations
â”‚   â”‚   â””â”€â”€ ðŸ“„ categoryService.ts
â”‚   â”œâ”€â”€ ðŸ“ store/
â”‚   â”‚   â””â”€â”€ ðŸ“„ productsSlice.ts     # Products, filters, sorting state
â”‚   â”œâ”€â”€ ðŸ“ types/
â”‚   â”‚   â””â”€â”€ ðŸ“„ index.ts             # Product, Category, Variant, etc.
â”‚   â””â”€â”€ ðŸ“ utils/
â”‚       â”œâ”€â”€ ðŸ“„ formatters.ts        # Format price, ratings
â”‚       â””â”€â”€ ðŸ“„ filters.ts           # Filter logic
â”‚
â”œâ”€â”€ ðŸ“ cart/                        # Shopping Cart Feature
â”‚   â”œâ”€â”€ ðŸ“„ index.ts
â”‚   â”œâ”€â”€ ðŸ“ components/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ CartWidget.tsx       # Header cart icon
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ CartDrawer.tsx       # Slide-out cart
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ CartItem.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ CartSummary.tsx
â”‚   â”‚   â””â”€â”€ ðŸ“„ DiscountCodeInput.tsx
â”‚   â”œâ”€â”€ ðŸ“ hooks/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ useCart.ts           # Add, remove, update cart
â”‚   â”‚   â””â”€â”€ ðŸ“„ useCartSync.ts       # Sync with backend
â”‚   â”œâ”€â”€ ðŸ“ services/
â”‚   â”‚   â””â”€â”€ ðŸ“„ cartService.ts       # Cart API calls
â”‚   â”œâ”€â”€ ðŸ“ store/
â”‚   â”‚   â””â”€â”€ ðŸ“„ cartSlice.ts         # Cart state + middleware for localStorage
â”‚   â”œâ”€â”€ ðŸ“ types/
â”‚   â”‚   â””â”€â”€ ðŸ“„ index.ts             # Cart, CartItem, Discount
â”‚   â””â”€â”€ ðŸ“ utils/
â”‚       â””â”€â”€ ðŸ“„ calculations.ts      # Calculate totals, discounts
â”‚
â”œâ”€â”€ ðŸ“ checkout/                    # Checkout Feature
â”‚   â”œâ”€â”€ ðŸ“„ index.ts
â”‚   â”œâ”€â”€ ðŸ“ components/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ CheckoutForm.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ AddressForm.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ PaymentForm.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ OrderSummary.tsx
â”‚   â”‚   â””â”€â”€ ðŸ“„ CheckoutStepper.tsx
â”‚   â”œâ”€â”€ ðŸ“ hooks/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ useCheckout.ts
â”‚   â”‚   â””â”€â”€ ðŸ“„ useOrderCreation.ts
â”‚   â”œâ”€â”€ ðŸ“ services/
â”‚   â”‚   â””â”€â”€ ðŸ“„ orderService.ts      # Create order, process payment
â”‚   â”œâ”€â”€ ðŸ“ store/
â”‚   â”‚   â””â”€â”€ ðŸ“„ checkoutSlice.ts     # Checkout state (step, shipping info)
â”‚   â”œâ”€â”€ ðŸ“ types/
â”‚   â”‚   â””â”€â”€ ðŸ“„ index.ts             # Order, Address, PaymentMethod
â”‚   â””â”€â”€ ðŸ“ utils/
â”‚       â””â”€â”€ ðŸ“„ validators.ts        # Address, payment validation
â”‚
â”œâ”€â”€ ðŸ“ chat/                        # AI Clerk Chat Feature
â”‚   â”œâ”€â”€ ðŸ“„ index.ts
â”‚   â”œâ”€â”€ ðŸ“ components/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ChatWidget.tsx       # Floating chat button + modal
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ChatMessage.tsx      # User/assistant message bubble
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ChatInput.tsx        # Text input
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ChatProductCard.tsx  # Rich product display in chat
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ ChatTypingIndicator.tsx
â”‚   â”‚   â””â”€â”€ ðŸ“„ ChatSuggestions.tsx  # Quick reply chips
â”‚   â”œâ”€â”€ ðŸ“ hooks/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ useChat.ts           # Send message, handle responses
â”‚   â”‚   â””â”€â”€ ðŸ“„ useChatHistory.ts    # Load chat history
â”‚   â”œâ”€â”€ ðŸ“ services/
â”‚   â”‚   â””â”€â”€ ðŸ“„ chatService.ts       # Chat API calls
â”‚   â”œâ”€â”€ ðŸ“ store/
â”‚   â”‚   â””â”€â”€ ðŸ“„ chatSlice.ts         # Messages, session, typing state
â”‚   â”œâ”€â”€ ðŸ“ types/
â”‚   â”‚   â””â”€â”€ ðŸ“„ index.ts             # Message, ChatSession, FunctionCall
â”‚   â””â”€â”€ ðŸ“ utils/
â”‚       â””â”€â”€ ðŸ“„ messageFormatter.ts  # Format messages for display
â”‚
â”œâ”€â”€ ðŸ“ haggle/                      # Haggle/Negotiation Feature
â”‚   â”œâ”€â”€ ðŸ“„ index.ts
â”‚   â”œâ”€â”€ ðŸ“ components/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ HaggleDialog.tsx     # Haggle modal
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ HaggleProgress.tsx   # Show negotiation progress
â”‚   â”‚   â””â”€â”€ ðŸ“„ DiscountBadge.tsx    # Display discount achieved
â”‚   â”œâ”€â”€ ðŸ“ hooks/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ useHaggle.ts         # Negotiate price
â”‚   â”‚   â””â”€â”€ ðŸ“„ useDiscountCode.ts   # Apply generated code
â”‚   â”œâ”€â”€ ðŸ“ services/
â”‚   â”‚   â””â”€â”€ ðŸ“„ haggleService.ts     # Haggle API calls
â”‚   â”œâ”€â”€ ðŸ“ store/
â”‚   â”‚   â””â”€â”€ ðŸ“„ haggleSlice.ts       # Haggle session state
â”‚   â”œâ”€â”€ ðŸ“ types/
â”‚   â”‚   â””â”€â”€ ðŸ“„ index.ts             # HaggleSession, DiscountCode
â”‚   â””â”€â”€ ðŸ“ utils/
â”‚       â”œâ”€â”€ ðŸ“„ priceCalculator.ts   # Calculate haggle price
â”‚       â”œâ”€â”€ ðŸ“„ sentimentAnalyzer.ts # Detect tone (polite/rude)
â”‚       â””â”€â”€ ðŸ“„ codeGenerator.ts     # Generate BDAY-20, etc.
â”‚
â””â”€â”€ ðŸ“ analytics/                   # User Activity Tracking (optional)
    â”œâ”€â”€ ðŸ“„ index.ts
    â”œâ”€â”€ ðŸ“ services/
    â”‚   â””â”€â”€ ðŸ“„ trackingService.ts   # Track user events
    â””â”€â”€ ðŸ“ types/
        â””â”€â”€ ðŸ“„ index.ts             # ActivityEvent, UserSession

================================================
ðŸ“ LANGCHAIN/ - AI INTEGRATION (MODULAR)
================================================

src/langchain/
â”‚
â”œâ”€â”€ ðŸ“„ index.ts                     # Main LangChain exports
â”‚
â”œâ”€â”€ ðŸ“ agents/                      # LangChain Agents
â”‚   â”œâ”€â”€ ðŸ“„ clerkAgent.ts            # Main AI Clerk agent
â”‚   â”œâ”€â”€ ðŸ“„ haggleAgent.ts           # Specialized haggle negotiator
â”‚   â””â”€â”€ ðŸ“„ productAgent.ts          # Product recommendation agent
â”‚
â”œâ”€â”€ ðŸ“ chains/                      # LangChain Chains
â”‚   â”œâ”€â”€ ðŸ“„ conversationChain.ts     # Main conversation chain
â”‚   â”œâ”€â”€ ðŸ“„ ragChain.ts              # RAG search chain
â”‚   â”œâ”€â”€ ðŸ“„ haggleChain.ts           # Price negotiation chain
â”‚   â””â”€â”€ ðŸ“„ recommendationChain.ts   # Product recommendation chain
â”‚
â”œâ”€â”€ ðŸ“ tools/                       # LangChain Tools (Function Calling)
â”‚   â”œâ”€â”€ ðŸ“„ index.ts                 # Export all tools
â”‚   â”œâ”€â”€ ðŸ“„ searchProductsTool.ts    # Search products by query
â”‚   â”œâ”€â”€ ðŸ“„ filterProductsTool.ts    # Filter products (price, category)
â”‚   â”œâ”€â”€ ðŸ“„ checkStockTool.ts        # Check product stock
â”‚   â”œâ”€â”€ ðŸ“„ addToCartTool.ts         # Add product to cart
â”‚   â”œâ”€â”€ ðŸ“„ applyDiscountTool.ts     # Apply discount code
â”‚   â”œâ”€â”€ ðŸ“„ hagglePriceTool.ts       # Negotiate price
â”‚   â”œâ”€â”€ ðŸ“„ getUserActivityTool.ts   # Get user's past activity
â”‚   â””â”€â”€ ðŸ“„ getRecommendationsTool.ts # Get personalized recommendations
â”‚
â”œâ”€â”€ ðŸ“ prompts/                     # Prompt Templates
â”‚   â”œâ”€â”€ ðŸ“„ clerkPersonality.ts      # Main clerk system prompt
â”‚   â”œâ”€â”€ ðŸ“„ hagglePrompts.ts         # Haggle conversation prompts
â”‚   â”œâ”€â”€ ðŸ“„ productPrompts.ts        # Product recommendation prompts
â”‚   â””â”€â”€ ðŸ“„ responseFormats.ts       # JSON response formats
â”‚
â”œâ”€â”€ ðŸ“ memory/                      # Conversation Memory
â”‚   â”œâ”€â”€ ðŸ“„ chatMemory.ts            # Store chat history
â”‚   â””â”€â”€ ðŸ“„ userContextMemory.ts     # Store user context (cart, preferences)
â”‚
â”œâ”€â”€ ðŸ“ embeddings/                  # Vector Embeddings
â”‚   â”œâ”€â”€ ðŸ“„ embeddingService.ts      # Generate embeddings (Gemini)
â”‚   â””â”€â”€ ðŸ“„ vectorStore.ts           # Supabase pgvector integration
â”‚
â”œâ”€â”€ ðŸ“ retrievers/                  # RAG Retrievers
â”‚   â”œâ”€â”€ ðŸ“„ productRetriever.ts      # Retrieve products by similarity
â”‚   â””â”€â”€ ðŸ“„ contextRetriever.ts      # Retrieve conversation context
â”‚
â””â”€â”€ ðŸ“ config/                      # LangChain Configuration
    â”œâ”€â”€ ðŸ“„ geminiConfig.ts          # Gemini API setup
    â”œâ”€â”€ ðŸ“„ toolConfig.ts            # Tool configurations
    â””â”€â”€ ðŸ“„ chainConfig.ts           # Chain configurations

================================================
ðŸ“ CORE/ - SHARED CORE MODULES
================================================

src/core/
â”‚
â”œâ”€â”€ ðŸ“ components/                  # Shared UI Components
â”‚   â”œâ”€â”€ ðŸ“ ui/                      # shadcn/ui components
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ button.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ input.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ card.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ badge.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ dialog.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ dropdown-menu.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ select.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ toast.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ skeleton.tsx
â”‚   â”‚   â””â”€â”€ ðŸ“„ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ ðŸ“ layout/
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ Header.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ Footer.tsx
â”‚   â”‚   â”œâ”€â”€ ðŸ“„ Navbar.tsx
â”‚   â”‚   â””â”€â”€ ðŸ“„ Sidebar.tsx
â”‚   â”‚
â”‚   â””â”€â”€ ðŸ“ common/
â”‚       â”œâ”€â”€ ðŸ“„ Logo.tsx
â”‚       â”œâ”€â”€ ðŸ“„ LoadingSpinner.tsx
â”‚       â”œâ”€â”€ ðŸ“„ ErrorMessage.tsx
â”‚       â”œâ”€â”€ ðŸ“„ EmptyState.tsx
â”‚       â””â”€â”€ ðŸ“„ Breadcrumbs.tsx
â”‚
â”œâ”€â”€ ðŸ“ hooks/                       # Shared Hooks
â”‚   â”œâ”€â”€ ðŸ“„ useDebounce.ts
â”‚   â”œâ”€â”€ ðŸ“„ useLocalStorage.ts
â”‚   â”œâ”€â”€ ðŸ“„ useMediaQuery.ts
â”‚   â”œâ”€â”€ ðŸ“„ useClickOutside.ts
â”‚   â””â”€â”€ ðŸ“„ useToast.ts
â”‚
â”œâ”€â”€ ðŸ“ utils/                       # Shared Utilities
â”‚   â”œâ”€â”€ ðŸ“„ cn.ts                    # Tailwind className merge
â”‚   â”œâ”€â”€ ðŸ“„ formatters.ts            # Format dates, currency, etc.
â”‚   â”œâ”€â”€ ðŸ“„ validators.ts            # Common validation functions
â”‚   â”œâ”€â”€ ðŸ“„ constants.ts             # App-wide constants
â”‚   â””â”€â”€ ðŸ“„ helpers.ts               # General helper functions
â”‚
â”œâ”€â”€ ðŸ“ types/                       # Shared Types
â”‚   â”œâ”€â”€ ðŸ“„ common.ts                # Common types (ID, Timestamp, etc.)
â”‚   â”œâ”€â”€ ðŸ“„ api.ts                   # API request/response types
â”‚   â””â”€â”€ ðŸ“„ env.ts                   # Environment variable types
â”‚
â””â”€â”€ ðŸ“ providers/                   # React Context Providers
    â”œâ”€â”€ ðŸ“„ ReduxProvider.tsx        # Redux store provider
    â”œâ”€â”€ ðŸ“„ ThemeProvider.tsx        # Theme provider (dark/light)
    â””â”€â”€ ðŸ“„ ToastProvider.tsx        # Toast notification provider

================================================
ðŸ“ INFRASTRUCTURE/ - INFRASTRUCTURE LAYER
================================================

src/infrastructure/
â”‚
â”œâ”€â”€ ðŸ“ database/                    # Database Layer
â”‚   â”œâ”€â”€ ðŸ“„ supabase.ts              # Supabase client
â”‚   â”œâ”€â”€ ðŸ“„ schema.ts                # Database schema types
â”‚   â””â”€â”€ ðŸ“ repositories/            # Data access layer
â”‚       â”œâ”€â”€ ðŸ“„ userRepository.ts
â”‚       â”œâ”€â”€ ðŸ“„ productRepository.ts
â”‚       â”œâ”€â”€ ðŸ“„ cartRepository.ts
â”‚       â”œâ”€â”€ ðŸ“„ orderRepository.ts
â”‚       â”œâ”€â”€ ðŸ“„ chatRepository.ts
â”‚       â””â”€â”€ ðŸ“„ haggleRepository.ts
â”‚
â”œâ”€â”€ ðŸ“ http/                        # HTTP Client
â”‚   â”œâ”€â”€ ðŸ“„ client.ts                # Axios/fetch wrapper
â”‚   â”œâ”€â”€ ðŸ“„ interceptors.ts          # Request/response interceptors
â”‚   â””â”€â”€ ðŸ“„ errorHandler.ts          # Global error handling
â”‚
â”œâ”€â”€ ðŸ“ auth/                        # Authentication Infrastructure
â”‚   â”œâ”€â”€ ðŸ“„ jwt.ts                   # JWT utilities
â”‚   â”œâ”€â”€ ðŸ“„ middleware.ts            # Auth middleware for API routes
â”‚   â””â”€â”€ ðŸ“„ session.ts               # Session management
â”‚
â”œâ”€â”€ ðŸ“ storage/                     # Storage Services
â”‚   â”œâ”€â”€ ðŸ“„ localStorage.ts          # Browser localStorage wrapper
â”‚   â””â”€â”€ ðŸ“„ sessionStorage.ts        # Browser sessionStorage wrapper
â”‚
â””â”€â”€ ðŸ“ config/                      # Infrastructure Config
    â”œâ”€â”€ ðŸ“„ env.ts                   # Environment variables
    â””â”€â”€ ðŸ“„ app.ts                   # App-wide configuration

================================================
ðŸ“ STORE/ - GLOBAL STATE MANAGEMENT
================================================

src/store/
â”œâ”€â”€ ðŸ“„ index.ts                     # Configure & export store
â”œâ”€â”€ ðŸ“„ hooks.ts                     # Typed useAppDispatch, useAppSelector
â”œâ”€â”€ ðŸ“„ rootReducer.ts               # Combine all feature slices
â”‚
â””â”€â”€ ðŸ“ middleware/
    â”œâ”€â”€ ðŸ“„ localStorageMiddleware.ts # Persist cart to localStorage
    â”œâ”€â”€ ðŸ“„ loggerMiddleware.ts      # Log Redux actions (dev only)
    â””â”€â”€ ðŸ“„ errorMiddleware.ts       # Global error handling

Note: Feature slices live in their respective feature folders
Example: src/features/cart/store/cartSlice.ts

================================================
ðŸ“ PUBLIC/ - STATIC ASSETS
================================================

public/
â”œâ”€â”€ ðŸ“ images/
â”‚   â”œâ”€â”€ ðŸ“ products/
â”‚   â”œâ”€â”€ ðŸ“ categories/
â”‚   â””â”€â”€ ðŸ“ icons/
â”œâ”€â”€ ðŸ“ fonts/                       # Custom fonts (if needed)
â”œâ”€â”€ ðŸ“„ favicon.ico
â”œâ”€â”€ ðŸ“„ next.svg
â””â”€â”€ ðŸ“„ vercel.svg

================================================
ðŸ”§ SCRIPTS/ - UTILITY SCRIPTS (OPTIONAL)
================================================

scripts/
â”œâ”€â”€ ðŸ“„ generateEmbeddings.ts        # Generate product embeddings
â”œâ”€â”€ ðŸ“„ seedDatabase.ts              # Seed initial data
â””â”€â”€ ðŸ“„ migrateDatabase.ts           # Run database migrations

================================================
KEY MODULE EXPLANATIONS
================================================

ðŸŽ¯ FEATURE MODULES (src/features/)
- Each feature is self-contained (components, hooks, services, state)
- Export a clean public API via index.ts
- Can be imported like: import { useAuth } from '@/features/auth'
- Easy to enable/disable features by removing folders

ðŸ¤– LANGCHAIN MODULES (src/langchain/)
- Agents: High-level AI agents for different tasks
- Chains: Composable LangChain chains
- Tools: Individual tools that AI can call
- Prompts: Reusable prompt templates
- Embeddings: Vector generation and search
- Memory: Conversation and context storage

âš™ï¸ CORE MODULES (src/core/)
- Shared UI components (design system)
- Common hooks and utilities
- Providers for global state/context

ðŸ—ï¸ INFRASTRUCTURE (src/infrastructure/)
- Database access layer (repositories)
- HTTP client with interceptors
- Auth middleware and JWT handling
- Storage wrappers

================================================
DEPENDENCY INJECTION & IMPORTS
================================================

Import Rules:
âœ… Features can import from: core, infrastructure, langchain
âœ… Core can import from: infrastructure only
âœ… Infrastructure: No imports from features or core
âŒ Features should NOT import from other features directly

Example Imports:
```typescript
// In src/features/chat/hooks/useChat.ts
import { useAppDispatch } from '@/store/hooks'           // Global store
import { clerkAgent } from '@/langchain/agents'          // LangChain
import { chatService } from '../services/chatService'    // Same feature
import { useToast } from '@/core/hooks'                  // Core

// In src/langchain/tools/addToCartTool.ts
import { cartRepository } from '@/infrastructure/database/repositories'
import { Product } from '@/features/products/types'
```

================================================
DATA FLOW EXAMPLES
================================================

1ï¸âƒ£ USER: "Show me linen suits for a summer wedding"

   Flow:
   â”œâ”€â”€ User types in ChatInput component
   â”œâ”€â”€ hooks/useChat.ts calls chatService.sendMessage()
   â”œâ”€â”€ POST /api/chat â†’ langchain/agents/clerkAgent.ts
   â”œâ”€â”€ Agent uses langchain/tools/searchProductsTool.ts
   â”œâ”€â”€ Tool calls langchain/chains/ragChain.ts
   â”œâ”€â”€ RAG chain generates embedding via embeddings/embeddingService.ts
   â”œâ”€â”€ Retriever queries Supabase pgvector
   â”œâ”€â”€ Returns products â†’ Agent formats response
   â”œâ”€â”€ API returns to frontend
   â”œâ”€â”€ chatSlice updates with new message
   â”œâ”€â”€ ChatMessage component displays results with ChatProductCard
   â””â”€â”€ User clicks product â†’ Navigate to product page

2ï¸âƒ£ USER: "Show me cheaper options"

   Flow:
   â”œâ”€â”€ Message sent to /api/chat
   â”œâ”€â”€ clerkAgent identifies intent: filter by price
   â”œâ”€â”€ Agent calls langchain/tools/filterProductsTool.ts
   â”œâ”€â”€ Tool dispatches Redux action: productsSlice.setSortBy('price_asc')
   â”œâ”€â”€ Agent also returns text: "Sorting by price, lowest first!"
   â”œâ”€â”€ Frontend:
   â”‚   â”œâ”€â”€ productsSlice updates â†’ triggers ProductGrid re-render
   â”‚   â”œâ”€â”€ Framer Motion animates product cards rearranging
   â”‚   â””â”€â”€ Chat displays confirmation message
   â””â”€â”€ UI is now sorted by price

3ï¸âƒ£ USER: "Can I get a discount? It's my birthday!"

   Flow:
   â”œâ”€â”€ Message sent to /api/chat
   â”œâ”€â”€ clerkAgent detects haggle intent â†’ delegates to haggleAgent
   â”œâ”€â”€ haggleAgent uses haggle/utils/sentimentAnalyzer.ts
   â”œâ”€â”€ Sentiment: 0.8 (polite), reason: "birthday"
   â”œâ”€â”€ Agent calls tools/hagglePriceTool.ts
   â”œâ”€â”€ Tool uses haggle/utils/priceCalculator.ts
   â”œâ”€â”€ Calculate: 15% discount (polite + special occasion)
   â”œâ”€â”€ Tool calls haggle/utils/codeGenerator.ts â†’ "BDAY-15"
   â”œâ”€â”€ Tool saves to haggle_sessions + discount_codes tables
   â”œâ”€â”€ Agent responds: "Happy birthday! Here's 15% off: BDAY-15"
   â”œâ”€â”€ Frontend displays discount code in chat
   â”œâ”€â”€ User can click "Apply to Cart"
   â”œâ”€â”€ Calls tools/applyDiscountTool.ts
   â”œâ”€â”€ Updates cartSlice with discount
   â””â”€â”€ Cart page shows new total

================================================
LANGCHAIN TOOL EXAMPLE
================================================

File: src/langchain/tools/addToCartTool.ts

```typescript
import { DynamicStructuredTool } from 'langchain/tools'
import { z } from 'zod'
import { cartRepository } from '@/infrastructure/database/repositories'

export const addToCartTool = new DynamicStructuredTool({
  name: 'add_to_cart',
  description: 'Add a product to the user cart',
  schema: z.object({
    productId: z.string().describe('The product ID to add'),
    quantity: z.number().default(1).describe('Quantity to add'),
    variantId: z.string().optional().describe('Product variant ID'),
  }),
  func: async ({ productId, quantity, variantId }, { sessionId }) => {
    const result = await cartRepository.addItem({
      sessionId,
      productId,
      quantity,
      variantId,
    })

    return `Added ${quantity}x product to cart. Cart now has ${result.totalItems} items.`
  },
})
```

================================================
MODULAR FEATURES - HOW TO ADD/REMOVE
================================================

Adding a new feature (e.g., "Wishlist"):

1. Create src/features/wishlist/
2. Add components, hooks, services, store, types
3. Export public API in src/features/wishlist/index.ts
4. Import in app pages: import { WishlistButton } from '@/features/wishlist'
5. Add to Redux: import wishlistSlice in src/store/rootReducer.ts

Removing a feature:

1. Delete src/features/wishlist/
2. Remove from rootReducer.ts
3. Remove API routes in src/app/api/wishlist/
4. Remove any imports from other files

================================================
ENVIRONMENT VARIABLES (.env.local)
================================================

# Gemini AI
GEMINI_API_KEY=your_gemini_api_key

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_key

# Authentication
JWT_SECRET=your_jwt_secret
JWT_EXPIRATION=7d

# App
NEXT_PUBLIC_APP_URL=http://localhost:3000

================================================
HACKATHON SCORING CHECKLIST
================================================

âœ… Clerk Personality (30 points)
   â””â”€â”€ langchain/prompts/clerkPersonality.ts - Funny, helpful AI
   â””â”€â”€ langchain/agents/clerkAgent.ts - Main agent logic

âœ… Visual Polish (30 points)
   â””â”€â”€ tailwind.config.ts - Apply color scheme
   â””â”€â”€ core/components/ui/ - shadcn components
   â””â”€â”€ Framer Motion in ProductGrid, ChatWidget

âœ… UI Integration (20 points)
   â””â”€â”€ langchain/tools/filterProductsTool.ts - Update Redux from chat
   â””â”€â”€ langchain/tools/addToCartTool.ts - Add to cart from chat
   â””â”€â”€ features/products/store/productsSlice.ts - State updates

âœ… Haggle Logic (20 points)
   â””â”€â”€ langchain/agents/haggleAgent.ts - Negotiation agent
   â””â”€â”€ features/haggle/utils/sentimentAnalyzer.ts - Detect tone
   â””â”€â”€ features/haggle/utils/priceCalculator.ts - Dynamic pricing
   â””â”€â”€ features/haggle/utils/codeGenerator.ts - Generate codes

================================================
DEVELOPMENT WORKFLOW
================================================

1. Clone repo
2. Create .env.local with API keys
3. npm install
4. Set up Supabase + run schema.txt SQL
5. npm run generate-embeddings (script to embed products)
6. npm run dev
7. Test features:
   - Chat: "Show me products"
   - RAG: "Something for a beach vacation"
   - Haggle: "Can I get a discount?"
   - UI Integration: "Show me cheaper options"
8. Deploy to Vercel

================================================
PACKAGE.JSON SCRIPTS
================================================

{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "generate-embeddings": "tsx scripts/generateEmbeddings.ts",
    "seed": "tsx scripts/seedDatabase.ts"
  }
}

================================================
END OF MODULAR FILE STRUCTURE
================================================
